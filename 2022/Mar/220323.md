# 패스트캠퍼스의 강의를 정리한 것
[링크](https://fastcampus.co.kr/data_online_ecommerce)
# Chapter 2


Linear Regression을 사용하여 고객별 연간 지출액을 예측


## 2-1 모듈 및 데이터 로딩



```python
import pandas as pd
import numpy as np

import matplotlib.pyplot as plt
import seaborn as sns
```


```python
data = pd.read_csv("data/ecommerce.csv")
```

## 2-2 데이터 특성 확인


#### 데이터 처음 부분 확인



```python
data.head()
```

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Email</th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mstephenson@fernandez.com</td>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hduke@hotmail.com</td>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pallen@yahoo.com</td>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>riverarebecca@gmail.com</td>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mstephens@davidson-herman.com</td>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
      <td>599.406092</td>
    </tr>
  </tbody>
</table>
</div>



```python
data.head(10)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Email</th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mstephenson@fernandez.com</td>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hduke@hotmail.com</td>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pallen@yahoo.com</td>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>riverarebecca@gmail.com</td>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mstephens@davidson-herman.com</td>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
      <td>599.406092</td>
    </tr>
    <tr>
      <th>5</th>
      <td>alvareznancy@lucas.biz</td>
      <td>645 Martha Park Apt. 611\nJeffreychester, MN 6...</td>
      <td>FloralWhite</td>
      <td>33.871038</td>
      <td>12.026925</td>
      <td>34.476878</td>
      <td>5.493507</td>
      <td>637.102448</td>
    </tr>
    <tr>
      <th>6</th>
      <td>katherine20@yahoo.com</td>
      <td>68388 Reyes Lights Suite 692\nJosephbury, WV 9...</td>
      <td>DarkSlateBlue</td>
      <td>32.021596</td>
      <td>11.366348</td>
      <td>36.683776</td>
      <td>4.685017</td>
      <td>521.572175</td>
    </tr>
    <tr>
      <th>7</th>
      <td>awatkins@yahoo.com</td>
      <td>Unit 6538 Box 8980\nDPO AP 09026-4941</td>
      <td>Aqua</td>
      <td>32.739143</td>
      <td>12.351959</td>
      <td>37.373359</td>
      <td>4.434273</td>
      <td>549.904146</td>
    </tr>
    <tr>
      <th>8</th>
      <td>vchurch@walter-martinez.com</td>
      <td>860 Lee Key\nWest Debra, SD 97450-0495</td>
      <td>Salmon</td>
      <td>33.987773</td>
      <td>13.386235</td>
      <td>37.534497</td>
      <td>3.273434</td>
      <td>570.200409</td>
    </tr>
    <tr>
      <th>9</th>
      <td>bonnie69@lin.biz</td>
      <td>PSC 2734, Box 5255\nAPO AA 98456-7482</td>
      <td>Brown</td>
      <td>31.936549</td>
      <td>11.814128</td>
      <td>37.145168</td>
      <td>3.202806</td>
      <td>427.199385</td>
    </tr>
  </tbody>
</table>
</div>


#### 데이터 끝 부분 확인



```python
data.tail()
```
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Email</th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>495</th>
      <td>lewisjessica@craig-evans.com</td>
      <td>4483 Jones Motorway Suite 872\nLake Jamiefurt,...</td>
      <td>Tan</td>
      <td>33.237660</td>
      <td>13.566160</td>
      <td>36.417985</td>
      <td>3.746573</td>
      <td>573.847438</td>
    </tr>
    <tr>
      <th>496</th>
      <td>katrina56@gmail.com</td>
      <td>172 Owen Divide Suite 497\nWest Richard, CA 19320</td>
      <td>PaleVioletRed</td>
      <td>34.702529</td>
      <td>11.695736</td>
      <td>37.190268</td>
      <td>3.576526</td>
      <td>529.049004</td>
    </tr>
    <tr>
      <th>497</th>
      <td>dale88@hotmail.com</td>
      <td>0787 Andrews Ranch Apt. 633\nSouth Chadburgh, ...</td>
      <td>Cornsilk</td>
      <td>32.646777</td>
      <td>11.499409</td>
      <td>38.332576</td>
      <td>4.958264</td>
      <td>551.620145</td>
    </tr>
    <tr>
      <th>498</th>
      <td>cwilson@hotmail.com</td>
      <td>680 Jennifer Lodge Apt. 808\nBrendachester, TX...</td>
      <td>Teal</td>
      <td>33.322501</td>
      <td>12.391423</td>
      <td>36.840086</td>
      <td>2.336485</td>
      <td>456.469510</td>
    </tr>
    <tr>
      <th>499</th>
      <td>hannahwilson@davidson.com</td>
      <td>49791 Rachel Heights Apt. 898\nEast Drewboroug...</td>
      <td>DarkMagenta</td>
      <td>33.715981</td>
      <td>12.418808</td>
      <td>35.771016</td>
      <td>2.735160</td>
      <td>497.778642</td>
    </tr>
  </tbody>
</table>
</div>


#### 데이터 정보 확인



```python
data.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 500 entries, 0 to 499
Data columns (total 8 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   Email                 500 non-null    object 
 1   Address               500 non-null    object 
 2   Avatar                500 non-null    object 
 3   Avg. Session Length   500 non-null    float64
 4   Time on App           500 non-null    float64
 5   Time on Website       500 non-null    float64
 6   Length of Membership  500 non-null    float64
 7   Yearly Amount Spent   500 non-null    float64
dtypes: float64(5), object(3)
memory usage: 31.4+ KB
</pre>
non-null이 총 데이터 수와 같아 결측치가 없음을 의미한다.


#### 데이터의 전반적인 수치들 확인



```python
data.describe()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
      <td>500.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>33.053194</td>
      <td>12.052488</td>
      <td>37.060445</td>
      <td>3.533462</td>
      <td>499.314038</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.992563</td>
      <td>0.994216</td>
      <td>1.010489</td>
      <td>0.999278</td>
      <td>79.314782</td>
    </tr>
    <tr>
      <th>min</th>
      <td>29.532429</td>
      <td>8.508152</td>
      <td>33.913847</td>
      <td>0.269901</td>
      <td>256.670582</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>32.341822</td>
      <td>11.388153</td>
      <td>36.349257</td>
      <td>2.930450</td>
      <td>445.038277</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.082008</td>
      <td>11.983231</td>
      <td>37.069367</td>
      <td>3.533975</td>
      <td>498.887875</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>33.711985</td>
      <td>12.753850</td>
      <td>37.716432</td>
      <td>4.126502</td>
      <td>549.313828</td>
    </tr>
    <tr>
      <th>max</th>
      <td>36.139662</td>
      <td>15.126994</td>
      <td>40.005182</td>
      <td>6.922689</td>
      <td>765.518462</td>
    </tr>
  </tbody>
</table>
</div>


데이터들의 스케일을 알 수 있다.  

스케일 : min ~ max



Outlier도 검출할 수 있다.  

75%와 max 사이에 엄청난 차이가 있다면 Outlier가 있을 수 있다.


## 2-3 불필요한 변수 처리


#### 컬럼 불러오기



```python
data['Length of Membership']
```

<pre>
0      4.082621
1      2.664034
2      4.104543
3      3.120179
4      4.446308
         ...   
495    3.746573
496    3.576526
497    4.958264
498    2.336485
499    2.735160
Name: Length of Membership, Length: 500, dtype: float64
</pre>
두 개 이상의 컬럼을 불러올 때는 대괄호를 하나 더



```python
data[['Length of Membership', 'Yearly Amount Spent']]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.082621</td>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.664034</td>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.104543</td>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.120179</td>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.446308</td>
      <td>599.406092</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>3.746573</td>
      <td>573.847438</td>
    </tr>
    <tr>
      <th>496</th>
      <td>3.576526</td>
      <td>529.049004</td>
    </tr>
    <tr>
      <th>497</th>
      <td>4.958264</td>
      <td>551.620145</td>
    </tr>
    <tr>
      <th>498</th>
      <td>2.336485</td>
      <td>456.469510</td>
    </tr>
    <tr>
      <th>499</th>
      <td>2.735160</td>
      <td>497.778642</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 2 columns</p>
</div>



```python
data = data[['Avg. Session Length', 'Time on App', 'Time on Website', 'Length of Membership', 'Yearly Amount Spent']]
```


```python
data.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
      <td>599.406092</td>
    </tr>
  </tbody>
</table>
</div>


## 2-4 Train Test Split


정의 : 데이터를 테스트와 학습 용으로 나누는 것



idea : 학습할 때 사용한 데이터 이외의 데이터가 들어왔을 때 잘 처리할 수 있는가를 확인할 수 있어야 함


#### 데이터 나누기



```python
from sklearn.model_selection import train_test_split
```

X는 독립변수, y는 종속변수


> X_train, X_test, y_train, y_test = train_test_split(X, y)


X와 y 정의



```python
X = data[['Avg. Session Length', 'Time on App', 'Time on Website', 'Length of Membership']]
```


```python
y = data['Yearly Amount Spent']
```

데이터 분리


분리되는 비율을 지정할 수 있고, 디폴트는 test에 1/3



```python
X_train, X_test, y_train, y_test = train_test_split(X, y)
```

비율을 지정할 때 train data의 양이 충분한지 확인해야 한다.  

test_size가 비율, random_state는 랜덤 시드 값 정도로 생각하면 된다.



```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=100)
```


```python
X_train
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>205</th>
      <td>34.967610</td>
      <td>13.919494</td>
      <td>37.952013</td>
      <td>5.066697</td>
    </tr>
    <tr>
      <th>404</th>
      <td>32.278443</td>
      <td>12.527472</td>
      <td>36.688367</td>
      <td>3.531402</td>
    </tr>
    <tr>
      <th>337</th>
      <td>31.827979</td>
      <td>12.461147</td>
      <td>37.428997</td>
      <td>2.974737</td>
    </tr>
    <tr>
      <th>440</th>
      <td>33.200616</td>
      <td>11.965980</td>
      <td>36.831536</td>
      <td>3.549036</td>
    </tr>
    <tr>
      <th>55</th>
      <td>33.925297</td>
      <td>11.588655</td>
      <td>35.252242</td>
      <td>3.392050</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>343</th>
      <td>32.302748</td>
      <td>12.815393</td>
      <td>37.957810</td>
      <td>4.615426</td>
    </tr>
    <tr>
      <th>359</th>
      <td>32.054262</td>
      <td>13.149670</td>
      <td>37.650400</td>
      <td>4.195614</td>
    </tr>
    <tr>
      <th>323</th>
      <td>32.762456</td>
      <td>10.952353</td>
      <td>37.646292</td>
      <td>4.019470</td>
    </tr>
    <tr>
      <th>280</th>
      <td>32.271848</td>
      <td>13.485009</td>
      <td>37.550880</td>
      <td>3.086337</td>
    </tr>
    <tr>
      <th>8</th>
      <td>33.987773</td>
      <td>13.386235</td>
      <td>37.534497</td>
      <td>3.273434</td>
    </tr>
  </tbody>
</table>
<p>400 rows × 4 columns</p>
</div>


## 2-5 Linear Regression Model 생성



```python
import statsmodels.api as sm
```


```python
model = sm.OLS(y_train, X_train)
```

#### 훈련



```python
model = model.fit()
```

#### Linear Regression Report 확인



```python
model.summary()
```
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>    <td>Yearly Amount Spent</td> <th>  R-squared (uncentered):</th>      <td>   0.998</td> 
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>         <th>  Adj. R-squared (uncentered):</th> <td>   0.998</td> 
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th>          <td>4.798e+04</td>
</tr>
<tr>
  <th>Date:</th>              <td>Wed, 23 Mar 2022</td>   <th>  Prob (F-statistic):</th>           <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                  <td>18:18:14</td>       <th>  Log-Likelihood:    </th>          <td> -1820.0</td> 
</tr>
<tr>
  <th>No. Observations:</th>       <td>   400</td>        <th>  AIC:               </th>          <td>   3648.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>           <td>   396</td>        <th>  BIC:               </th>          <td>   3664.</td> 
</tr>
<tr>
  <th>Df Model:</th>               <td>     4</td>        <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
            <td></td>              <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Avg. Session Length</th>  <td>   11.9059</td> <td>    0.869</td> <td>   13.696</td> <td> 0.000</td> <td>   10.197</td> <td>   13.615</td>
</tr>
<tr>
  <th>Time on App</th>          <td>   34.3257</td> <td>    1.121</td> <td>   30.610</td> <td> 0.000</td> <td>   32.121</td> <td>   36.530</td>
</tr>
<tr>
  <th>Time on Website</th>      <td>  -14.1405</td> <td>    0.812</td> <td>  -17.405</td> <td> 0.000</td> <td>  -15.738</td> <td>  -12.543</td>
</tr>
<tr>
  <th>Length of Membership</th> <td>   61.0149</td> <td>    1.144</td> <td>   53.318</td> <td> 0.000</td> <td>   58.765</td> <td>   63.265</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 0.490</td> <th>  Durbin-Watson:     </th> <td>   1.987</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.783</td> <th>  Jarque-Bera (JB):  </th> <td>   0.606</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.022</td> <th>  Prob(JB):          </th> <td>   0.739</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.814</td> <th>  Cond. No.          </th> <td>    55.4</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.

R-squared

- 클수록 좋은 모델

- Adj.가 더욱 적절한 평가 기준

- 그냥 R-squared는 독립변수의 개수가 많아지면 증가할 수 밖에 없음

- Adj.는 독립변수의 개수를 고려 가중치를 통해 수치를 표현



Coef

- 변수의 영향력 (강도와 방향)

- 기울기(1이 증가할 때 증가하는 수치)

- 스케일이 다른 경우 공정한 비교가 되지 않을 수도 있음 (e.g. 연봉의 1원과 시간의 1년)



P-value

- 신뢰할 수 있는 결과인가  평가한 척도

- 0~1 범위

- 0.05 이하면 양호

- 0.05 이상이면 데이터를 신뢰할 수 없다고 판단


SST : 평균값과 실제값의 오차  

SSE : 실제값과 예측값의 오차  

SSR : 예측값과 실제값의 오차



R-Squared = SSR/SST


## 2-6 모델을 활용하여 예측하고 평가


#### 예측



```python
pred = model.predict(X_test)
```

#### 시각화



```python
plt.figure(figsize=(10, 10))
sns.scatterplot(x=y_test, y=pred)
```

#### MSE(Mean Squared Error)


MSE(Mean Squared Error) : 예측값과 실제 테스트 값과의 오차의 제곱의 평균



문제

- 그냥 오차를 더해서 평균을 내는 경우 방향성 때문에 제대로 된 오차를 계산하기 어렵다.



해결 방안

1. 절댓값

2. 제곱



```python
from sklearn.metrics import mean_squared_error
```


```python
mean_squared_error(y_test, pred)
```

<pre>
482.28901390889246
</pre>
위의 수치만 보고 수치의 좋고 나쁨을 판단할 수 없다.



다른 모델의 수치와 비교할 때 의미를 갖는다.


#### RMSE(Root Mean Squared Error)


MSE는 오차가 제곱만큼 커져서 계산이 되기 때문에 결과 값이 원래 y 값의 스케일보다 너무 큰 느낌을 준다.



이를 해결하기 위해 루트를 씌워주는 것



```python
np.sqrt(mean_squared_error(y_test, pred))
```

<pre>
21.961079525125637
</pre>
MSE와 마찬가지로 이 값 하나만으로는 좋고 나쁨을 판단할 수 없다.


## 2-7 Numpy and Pandas


Numpy array는 연산 속도가 빠름  

Numpy와 Pandas는 상호 호환


#### Numpy



```python
a = [1, 2, 3]
b = [4, 5, 6]
```


```python
np.array(a)
```

<pre>
array([1, 2, 3])
</pre>

```python
np.array([a, b])
```

<pre>
array([[1, 2, 3],
       [4, 5, 6]])
</pre>
#### Pandas



```python
pd.DataFrame([a, b])
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>


컬럼명과 행 이름도 바꿀 수 있음



```python
pd.DataFrame([a, b], columns=['a','b','c'], index=['x','y'])
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>y</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>


Series는 1차원



```python
pd.Series(a)
```

<pre>
0    1
1    2
2    3
dtype: int64
</pre>

```python
data = pd.read_csv('data/eCommerce.csv')
```

DataFrame에서 한 컬럼만 불러오면 Series type임



```python
type(data)
```

<pre>
pandas.core.frame.DataFrame
</pre>

```python
type(data['Yearly Amount Spent'])
```

<pre>
pandas.core.series.Series
</pre>
Series를 DataFrame으로 형변환이 가능하다.



```python
pd.DataFrame(data['Yearly Amount Spent'])
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>599.406092</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>573.847438</td>
    </tr>
    <tr>
      <th>496</th>
      <td>529.049004</td>
    </tr>
    <tr>
      <th>497</th>
      <td>551.620145</td>
    </tr>
    <tr>
      <th>498</th>
      <td>456.469510</td>
    </tr>
    <tr>
      <th>499</th>
      <td>497.778642</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 1 columns</p>
</div>


Pandas와 Numpy간의 호환



```python
pd.DataFrame(np.array([a, b]))
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>



```python
np.array(data)
```

<pre>
array([['mstephenson@fernandez.com',
        '835 Frank Tunnel\nWrightmouth, MI 82180-9605', 'Violet', ...,
        39.57766801952616, 4.0826206329529615, 587.9510539684005],
       ['hduke@hotmail.com',
        '4547 Archer Common\nDiazchester, CA 06566-8576', 'DarkGreen',
        ..., 37.268958868297744, 2.66403418213262, 392.2049334443264],
       ['pallen@yahoo.com',
        '24645 Valerie Unions Suite 582\nCobbborough, DC 99414-7564',
        'Bisque', ..., 37.110597442120856, 4.104543202376424,
        487.54750486747207],
       ...,
       ['dale88@hotmail.com',
        '0787 Andrews Ranch Apt. 633\nSouth Chadburgh, TN 56128',
        'Cornsilk', ..., 38.33257633196044, 4.958264472618699,
        551.6201454762477],
       ['cwilson@hotmail.com',
        '680 Jennifer Lodge Apt. 808\nBrendachester, TX 05000-5873',
        'Teal', ..., 36.84008572976701, 2.336484668112853,
        456.469510066298],
       ['hannahwilson@davidson.com',
        '49791 Rachel Heights Apt. 898\nEast Drewborough, OR 55919-9528',
        'DarkMagenta', ..., 35.771016191612965, 2.7351595670822757,
        497.7786422156802]], dtype=object)
</pre>
#### Pandas Indexing



```python
data['Yearly Amount Spent']
```

<pre>
0      587.951054
1      392.204933
2      487.547505
3      581.852344
4      599.406092
          ...    
495    573.847438
496    529.049004
497    551.620145
498    456.469510
499    497.778642
Name: Yearly Amount Spent, Length: 500, dtype: float64
</pre>
두 컬럼 이상을 불러올 때 []를 한번 더 사용하는 이유는 리스트라는 하나의 객체로 만들어 전달하기 위함



```python
data[['Time on App', 'Time on Website']]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Time on App</th>
      <th>Time on Website</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12.655651</td>
      <td>39.577668</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11.109461</td>
      <td>37.268959</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.330278</td>
      <td>37.110597</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13.717514</td>
      <td>36.721283</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12.795189</td>
      <td>37.536653</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>13.566160</td>
      <td>36.417985</td>
    </tr>
    <tr>
      <th>496</th>
      <td>11.695736</td>
      <td>37.190268</td>
    </tr>
    <tr>
      <th>497</th>
      <td>11.499409</td>
      <td>38.332576</td>
    </tr>
    <tr>
      <th>498</th>
      <td>12.391423</td>
      <td>36.840086</td>
    </tr>
    <tr>
      <th>499</th>
      <td>12.418808</td>
      <td>35.771016</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 2 columns</p>
</div>


#### 특정 컬럼 제거


drop은 원래 행에서 이름을 찾아 제거한다.  

컬럼을 제거하기 위해서는 axis=1을 옵션으로 주면 된다.



```python
data.drop('Yearly Amount Spent', axis=1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Email</th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mstephenson@fernandez.com</td>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hduke@hotmail.com</td>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pallen@yahoo.com</td>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>riverarebecca@gmail.com</td>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mstephens@davidson-herman.com</td>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>lewisjessica@craig-evans.com</td>
      <td>4483 Jones Motorway Suite 872\nLake Jamiefurt,...</td>
      <td>Tan</td>
      <td>33.237660</td>
      <td>13.566160</td>
      <td>36.417985</td>
      <td>3.746573</td>
    </tr>
    <tr>
      <th>496</th>
      <td>katrina56@gmail.com</td>
      <td>172 Owen Divide Suite 497\nWest Richard, CA 19320</td>
      <td>PaleVioletRed</td>
      <td>34.702529</td>
      <td>11.695736</td>
      <td>37.190268</td>
      <td>3.576526</td>
    </tr>
    <tr>
      <th>497</th>
      <td>dale88@hotmail.com</td>
      <td>0787 Andrews Ranch Apt. 633\nSouth Chadburgh, ...</td>
      <td>Cornsilk</td>
      <td>32.646777</td>
      <td>11.499409</td>
      <td>38.332576</td>
      <td>4.958264</td>
    </tr>
    <tr>
      <th>498</th>
      <td>cwilson@hotmail.com</td>
      <td>680 Jennifer Lodge Apt. 808\nBrendachester, TX...</td>
      <td>Teal</td>
      <td>33.322501</td>
      <td>12.391423</td>
      <td>36.840086</td>
      <td>2.336485</td>
    </tr>
    <tr>
      <th>499</th>
      <td>hannahwilson@davidson.com</td>
      <td>49791 Rachel Heights Apt. 898\nEast Drewboroug...</td>
      <td>DarkMagenta</td>
      <td>33.715981</td>
      <td>12.418808</td>
      <td>35.771016</td>
      <td>2.735160</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 7 columns</p>
</div>


drop도 마찬가지로 두 개 이상의 컬럼을 제거할 때는 []를 써준다.



```python
data.drop(['Email', 'Yearly Amount Spent'], axis=1)
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>4483 Jones Motorway Suite 872\nLake Jamiefurt,...</td>
      <td>Tan</td>
      <td>33.237660</td>
      <td>13.566160</td>
      <td>36.417985</td>
      <td>3.746573</td>
    </tr>
    <tr>
      <th>496</th>
      <td>172 Owen Divide Suite 497\nWest Richard, CA 19320</td>
      <td>PaleVioletRed</td>
      <td>34.702529</td>
      <td>11.695736</td>
      <td>37.190268</td>
      <td>3.576526</td>
    </tr>
    <tr>
      <th>497</th>
      <td>0787 Andrews Ranch Apt. 633\nSouth Chadburgh, ...</td>
      <td>Cornsilk</td>
      <td>32.646777</td>
      <td>11.499409</td>
      <td>38.332576</td>
      <td>4.958264</td>
    </tr>
    <tr>
      <th>498</th>
      <td>680 Jennifer Lodge Apt. 808\nBrendachester, TX...</td>
      <td>Teal</td>
      <td>33.322501</td>
      <td>12.391423</td>
      <td>36.840086</td>
      <td>2.336485</td>
    </tr>
    <tr>
      <th>499</th>
      <td>49791 Rachel Heights Apt. 898\nEast Drewboroug...</td>
      <td>DarkMagenta</td>
      <td>33.715981</td>
      <td>12.418808</td>
      <td>35.771016</td>
      <td>2.735160</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 6 columns</p>
</div>


drop은 원본 데이터를 수정하지 않는다.



```python
data
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Email</th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
      <th>Yearly Amount Spent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mstephenson@fernandez.com</td>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
      <td>587.951054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hduke@hotmail.com</td>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
      <td>392.204933</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pallen@yahoo.com</td>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
      <td>487.547505</td>
    </tr>
    <tr>
      <th>3</th>
      <td>riverarebecca@gmail.com</td>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
      <td>581.852344</td>
    </tr>
    <tr>
      <th>4</th>
      <td>mstephens@davidson-herman.com</td>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
      <td>599.406092</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>lewisjessica@craig-evans.com</td>
      <td>4483 Jones Motorway Suite 872\nLake Jamiefurt,...</td>
      <td>Tan</td>
      <td>33.237660</td>
      <td>13.566160</td>
      <td>36.417985</td>
      <td>3.746573</td>
      <td>573.847438</td>
    </tr>
    <tr>
      <th>496</th>
      <td>katrina56@gmail.com</td>
      <td>172 Owen Divide Suite 497\nWest Richard, CA 19320</td>
      <td>PaleVioletRed</td>
      <td>34.702529</td>
      <td>11.695736</td>
      <td>37.190268</td>
      <td>3.576526</td>
      <td>529.049004</td>
    </tr>
    <tr>
      <th>497</th>
      <td>dale88@hotmail.com</td>
      <td>0787 Andrews Ranch Apt. 633\nSouth Chadburgh, ...</td>
      <td>Cornsilk</td>
      <td>32.646777</td>
      <td>11.499409</td>
      <td>38.332576</td>
      <td>4.958264</td>
      <td>551.620145</td>
    </tr>
    <tr>
      <th>498</th>
      <td>cwilson@hotmail.com</td>
      <td>680 Jennifer Lodge Apt. 808\nBrendachester, TX...</td>
      <td>Teal</td>
      <td>33.322501</td>
      <td>12.391423</td>
      <td>36.840086</td>
      <td>2.336485</td>
      <td>456.469510</td>
    </tr>
    <tr>
      <th>499</th>
      <td>hannahwilson@davidson.com</td>
      <td>49791 Rachel Heights Apt. 898\nEast Drewboroug...</td>
      <td>DarkMagenta</td>
      <td>33.715981</td>
      <td>12.418808</td>
      <td>35.771016</td>
      <td>2.735160</td>
      <td>497.778642</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 8 columns</p>
</div>


drop으로 원본 수정

1. data에 다시 대입

2. inplace=True 옵션 추가



```python
data.drop(['Email', 'Yearly Amount Spent'], axis=1, inplace=True)
```


```python
data
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>4483 Jones Motorway Suite 872\nLake Jamiefurt,...</td>
      <td>Tan</td>
      <td>33.237660</td>
      <td>13.566160</td>
      <td>36.417985</td>
      <td>3.746573</td>
    </tr>
    <tr>
      <th>496</th>
      <td>172 Owen Divide Suite 497\nWest Richard, CA 19320</td>
      <td>PaleVioletRed</td>
      <td>34.702529</td>
      <td>11.695736</td>
      <td>37.190268</td>
      <td>3.576526</td>
    </tr>
    <tr>
      <th>497</th>
      <td>0787 Andrews Ranch Apt. 633\nSouth Chadburgh, ...</td>
      <td>Cornsilk</td>
      <td>32.646777</td>
      <td>11.499409</td>
      <td>38.332576</td>
      <td>4.958264</td>
    </tr>
    <tr>
      <th>498</th>
      <td>680 Jennifer Lodge Apt. 808\nBrendachester, TX...</td>
      <td>Teal</td>
      <td>33.322501</td>
      <td>12.391423</td>
      <td>36.840086</td>
      <td>2.336485</td>
    </tr>
    <tr>
      <th>499</th>
      <td>49791 Rachel Heights Apt. 898\nEast Drewboroug...</td>
      <td>DarkMagenta</td>
      <td>33.715981</td>
      <td>12.418808</td>
      <td>35.771016</td>
      <td>2.735160</td>
    </tr>
  </tbody>
</table>
<p>500 rows × 6 columns</p>
</div>


#### 특정 행 제거



```python
df = data.head(10)
```


```python
df.index = ['a', 'b','c','d','e','f','g','h','i','j']
```


```python
df
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
    </tr>
    <tr>
      <th>c</th>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
    </tr>
    <tr>
      <th>d</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>e</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>f</th>
      <td>645 Martha Park Apt. 611\nJeffreychester, MN 6...</td>
      <td>FloralWhite</td>
      <td>33.871038</td>
      <td>12.026925</td>
      <td>34.476878</td>
      <td>5.493507</td>
    </tr>
    <tr>
      <th>g</th>
      <td>68388 Reyes Lights Suite 692\nJosephbury, WV 9...</td>
      <td>DarkSlateBlue</td>
      <td>32.021596</td>
      <td>11.366348</td>
      <td>36.683776</td>
      <td>4.685017</td>
    </tr>
    <tr>
      <th>h</th>
      <td>Unit 6538 Box 8980\nDPO AP 09026-4941</td>
      <td>Aqua</td>
      <td>32.739143</td>
      <td>12.351959</td>
      <td>37.373359</td>
      <td>4.434273</td>
    </tr>
    <tr>
      <th>i</th>
      <td>860 Lee Key\nWest Debra, SD 97450-0495</td>
      <td>Salmon</td>
      <td>33.987773</td>
      <td>13.386235</td>
      <td>37.534497</td>
      <td>3.273434</td>
    </tr>
    <tr>
      <th>j</th>
      <td>PSC 2734, Box 5255\nAPO AA 98456-7482</td>
      <td>Brown</td>
      <td>31.936549</td>
      <td>11.814128</td>
      <td>37.145168</td>
      <td>3.202806</td>
    </tr>
  </tbody>
</table>
</div>


행을 추출할 때는 loc를 사용



```python
df.loc['d']
```

<pre>
Address                 1414 David Throughway\nPort Jason, OH 22070-1220
Avatar                                                       SaddleBrown
Avg. Session Length                                            34.305557
Time on App                                                    13.717514
Time on Website                                                36.721283
Length of Membership                                            3.120179
Name: d, dtype: object
</pre>
여러 행을 추출할 때는 인덱싱 사용



```python
df.loc['d':'h']
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>e</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>f</th>
      <td>645 Martha Park Apt. 611\nJeffreychester, MN 6...</td>
      <td>FloralWhite</td>
      <td>33.871038</td>
      <td>12.026925</td>
      <td>34.476878</td>
      <td>5.493507</td>
    </tr>
    <tr>
      <th>g</th>
      <td>68388 Reyes Lights Suite 692\nJosephbury, WV 9...</td>
      <td>DarkSlateBlue</td>
      <td>32.021596</td>
      <td>11.366348</td>
      <td>36.683776</td>
      <td>4.685017</td>
    </tr>
    <tr>
      <th>h</th>
      <td>Unit 6538 Box 8980\nDPO AP 09026-4941</td>
      <td>Aqua</td>
      <td>32.739143</td>
      <td>12.351959</td>
      <td>37.373359</td>
      <td>4.434273</td>
    </tr>
  </tbody>
</table>
</div>


인덱스 번호로 추출할 때는 iloc 사용  

마지막 번호는 포함 안됨



```python
df.iloc[3:7]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>e</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>f</th>
      <td>645 Martha Park Apt. 611\nJeffreychester, MN 6...</td>
      <td>FloralWhite</td>
      <td>33.871038</td>
      <td>12.026925</td>
      <td>34.476878</td>
      <td>5.493507</td>
    </tr>
    <tr>
      <th>g</th>
      <td>68388 Reyes Lights Suite 692\nJosephbury, WV 9...</td>
      <td>DarkSlateBlue</td>
      <td>32.021596</td>
      <td>11.366348</td>
      <td>36.683776</td>
      <td>4.685017</td>
    </tr>
  </tbody>
</table>
</div>



```python
df.iloc[3:]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>d</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
      <td>13.717514</td>
      <td>36.721283</td>
      <td>3.120179</td>
    </tr>
    <tr>
      <th>e</th>
      <td>14023 Rodriguez Passage\nPort Jacobville, PR 3...</td>
      <td>MediumAquaMarine</td>
      <td>33.330673</td>
      <td>12.795189</td>
      <td>37.536653</td>
      <td>4.446308</td>
    </tr>
    <tr>
      <th>f</th>
      <td>645 Martha Park Apt. 611\nJeffreychester, MN 6...</td>
      <td>FloralWhite</td>
      <td>33.871038</td>
      <td>12.026925</td>
      <td>34.476878</td>
      <td>5.493507</td>
    </tr>
    <tr>
      <th>g</th>
      <td>68388 Reyes Lights Suite 692\nJosephbury, WV 9...</td>
      <td>DarkSlateBlue</td>
      <td>32.021596</td>
      <td>11.366348</td>
      <td>36.683776</td>
      <td>4.685017</td>
    </tr>
    <tr>
      <th>h</th>
      <td>Unit 6538 Box 8980\nDPO AP 09026-4941</td>
      <td>Aqua</td>
      <td>32.739143</td>
      <td>12.351959</td>
      <td>37.373359</td>
      <td>4.434273</td>
    </tr>
    <tr>
      <th>i</th>
      <td>860 Lee Key\nWest Debra, SD 97450-0495</td>
      <td>Salmon</td>
      <td>33.987773</td>
      <td>13.386235</td>
      <td>37.534497</td>
      <td>3.273434</td>
    </tr>
    <tr>
      <th>j</th>
      <td>PSC 2734, Box 5255\nAPO AA 98456-7482</td>
      <td>Brown</td>
      <td>31.936549</td>
      <td>11.814128</td>
      <td>37.145168</td>
      <td>3.202806</td>
    </tr>
  </tbody>
</table>
</div>



```python
df.iloc[:3]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
      <th>Time on App</th>
      <th>Time on Website</th>
      <th>Length of Membership</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>835 Frank Tunnel\nWrightmouth, MI 82180-9605</td>
      <td>Violet</td>
      <td>34.497268</td>
      <td>12.655651</td>
      <td>39.577668</td>
      <td>4.082621</td>
    </tr>
    <tr>
      <th>b</th>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
      <td>11.109461</td>
      <td>37.268959</td>
      <td>2.664034</td>
    </tr>
    <tr>
      <th>c</th>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
      <td>11.330278</td>
      <td>37.110597</td>
      <td>4.104543</td>
    </tr>
  </tbody>
</table>
</div>


iloc으로 컬럼도 인덱싱할 수 있다.



```python
df.iloc[1:4, 0:3]
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Address</th>
      <th>Avatar</th>
      <th>Avg. Session Length</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>b</th>
      <td>4547 Archer Common\nDiazchester, CA 06566-8576</td>
      <td>DarkGreen</td>
      <td>31.926272</td>
    </tr>
    <tr>
      <th>c</th>
      <td>24645 Valerie Unions Suite 582\nCobbborough, D...</td>
      <td>Bisque</td>
      <td>33.000915</td>
    </tr>
    <tr>
      <th>d</th>
      <td>1414 David Throughway\nPort Jason, OH 22070-1220</td>
      <td>SaddleBrown</td>
      <td>34.305557</td>
    </tr>
  </tbody>
</table>
</div>


## 2-8 Linear Regression 원리


데이터를 표현하기 위한 선들이 여러 개 그려지는데 이 중에서 가장 잘 설명할 수 있는 선을 찾는 것이 Linear Regression이다.



이 선을 찾는 방법은 예측값과 실제값의 오차의 평균이 가장 작은 선을 찾는 것이다.



Gradient Descent(경사하강법)을 사용해서 선을 찾는데 도움을 준다.


## 2-9 수식 만들기



```python
model.summary()
```

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>    <td>Yearly Amount Spent</td> <th>  R-squared (uncentered):</th>      <td>   0.998</td> 
</tr>
<tr>
  <th>Model:</th>                    <td>OLS</td>         <th>  Adj. R-squared (uncentered):</th> <td>   0.998</td> 
</tr>
<tr>
  <th>Method:</th>              <td>Least Squares</td>    <th>  F-statistic:       </th>          <td>4.798e+04</td>
</tr>
<tr>
  <th>Date:</th>              <td>Wed, 23 Mar 2022</td>   <th>  Prob (F-statistic):</th>           <td>  0.00</td>  
</tr>
<tr>
  <th>Time:</th>                  <td>20:11:49</td>       <th>  Log-Likelihood:    </th>          <td> -1820.0</td> 
</tr>
<tr>
  <th>No. Observations:</th>       <td>   400</td>        <th>  AIC:               </th>          <td>   3648.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>           <td>   396</td>        <th>  BIC:               </th>          <td>   3664.</td> 
</tr>
<tr>
  <th>Df Model:</th>               <td>     4</td>        <th>                     </th>              <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>       <td>nonrobust</td>      <th>                     </th>              <td> </td>    
</tr>
</table>
<table class="simpletable">
<tr>
            <td></td>              <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Avg. Session Length</th>  <td>   11.9059</td> <td>    0.869</td> <td>   13.696</td> <td> 0.000</td> <td>   10.197</td> <td>   13.615</td>
</tr>
<tr>
  <th>Time on App</th>          <td>   34.3257</td> <td>    1.121</td> <td>   30.610</td> <td> 0.000</td> <td>   32.121</td> <td>   36.530</td>
</tr>
<tr>
  <th>Time on Website</th>      <td>  -14.1405</td> <td>    0.812</td> <td>  -17.405</td> <td> 0.000</td> <td>  -15.738</td> <td>  -12.543</td>
</tr>
<tr>
  <th>Length of Membership</th> <td>   61.0149</td> <td>    1.144</td> <td>   53.318</td> <td> 0.000</td> <td>   58.765</td> <td>   63.265</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 0.490</td> <th>  Durbin-Watson:     </th> <td>   1.987</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.783</td> <th>  Jarque-Bera (JB):  </th> <td>   0.606</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.022</td> <th>  Prob(JB):          </th> <td>   0.739</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.814</td> <th>  Cond. No.          </th> <td>    55.4</td>
</tr>
</table><br/><br/>Notes:<br/>[1] R² is computed without centering (uncentered) since the model does not contain a constant.<br/>[2] Standard Errors assume that the covariance matrix of the errors is correctly specified.


#### summary로 수식 만들기


y = sum(coef*column)



y = 11.9059*Avg. Session Length + 34.3257*Time on App + ...

# Chapter 3


Logistic Regression을 사용하여 고객별 광고 반응율을 예측



Logistic Regression은 이진 분류



```python
import numpy as np
import pandas as pd

import seaborn as sns
import matplotlib.pyplot as plt
```

## 데이터 로딩 및 데이터 확인



```python
data = pd.read_csv('data/advertising.csv')
```


```python
data.head()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Daily Time Spent on Site</th>
      <th>Age</th>
      <th>Area Income</th>
      <th>Daily Internet Usage</th>
      <th>Ad Topic Line</th>
      <th>City</th>
      <th>Male</th>
      <th>Country</th>
      <th>Timestamp</th>
      <th>Clicked on Ad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>68.95</td>
      <td>NaN</td>
      <td>61833.90</td>
      <td>256.09</td>
      <td>Cloned 5thgeneration orchestration</td>
      <td>Wrightburgh</td>
      <td>0</td>
      <td>Tunisia</td>
      <td>3/27/2016 0:53</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>80.23</td>
      <td>31.0</td>
      <td>68441.85</td>
      <td>193.77</td>
      <td>Monitored national standardization</td>
      <td>West Jodi</td>
      <td>1</td>
      <td>Nauru</td>
      <td>4/4/2016 1:39</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>69.47</td>
      <td>26.0</td>
      <td>59785.94</td>
      <td>236.50</td>
      <td>Organic bottom-line service-desk</td>
      <td>Davidton</td>
      <td>0</td>
      <td>San Marino</td>
      <td>3/13/2016 20:35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74.15</td>
      <td>29.0</td>
      <td>54806.18</td>
      <td>245.89</td>
      <td>Triple-buffered reciprocal time-frame</td>
      <td>West Terrifurt</td>
      <td>1</td>
      <td>Italy</td>
      <td>1/10/2016 2:31</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>68.37</td>
      <td>35.0</td>
      <td>73889.99</td>
      <td>225.58</td>
      <td>Robust logistical utilization</td>
      <td>South Manuel</td>
      <td>0</td>
      <td>Iceland</td>
      <td>6/3/2016 3:36</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>


컬럼 뜻

- Daily Time on Site

    - 사이트에 머문 시간

- Age

    - 나이

- Area Income

    - 개인의 수입을 특정할 수 없어 해당 지역의 평균 수입을 나타냄

- Daily Internet Usage

    - 하루 인터넷 사용 시간

- Ad Topic Line

    - 광고에 대한 설명

- City

    - 사용자 도시

- Male

    - 성별 (여자면 0, 남자면 1)

- Country

    - 사용자 국가

- Timestamp

    - 시간과 관련됨

- Clicked on Ad

    - 광고를 클릭하지 않았으면 0, 했으면 1


NaN은 비어있는 값이다.



```python
data.tail()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Daily Time Spent on Site</th>
      <th>Age</th>
      <th>Area Income</th>
      <th>Daily Internet Usage</th>
      <th>Ad Topic Line</th>
      <th>City</th>
      <th>Male</th>
      <th>Country</th>
      <th>Timestamp</th>
      <th>Clicked on Ad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>995</th>
      <td>72.97</td>
      <td>30.0</td>
      <td>71384.57</td>
      <td>208.58</td>
      <td>Fundamental modular algorithm</td>
      <td>Duffystad</td>
      <td>1</td>
      <td>Lebanon</td>
      <td>2/11/2016 21:49</td>
      <td>1</td>
    </tr>
    <tr>
      <th>996</th>
      <td>51.30</td>
      <td>45.0</td>
      <td>67782.17</td>
      <td>134.42</td>
      <td>Grass-roots cohesive monitoring</td>
      <td>New Darlene</td>
      <td>1</td>
      <td>Bosnia and Herzegovina</td>
      <td>4/22/2016 2:07</td>
      <td>1</td>
    </tr>
    <tr>
      <th>997</th>
      <td>51.63</td>
      <td>51.0</td>
      <td>42415.72</td>
      <td>120.37</td>
      <td>Expanded intangible solution</td>
      <td>South Jessica</td>
      <td>1</td>
      <td>Mongolia</td>
      <td>2/1/2016 17:24</td>
      <td>1</td>
    </tr>
    <tr>
      <th>998</th>
      <td>55.55</td>
      <td>19.0</td>
      <td>41920.79</td>
      <td>187.95</td>
      <td>Proactive bandwidth-monitored policy</td>
      <td>West Steven</td>
      <td>0</td>
      <td>Guatemala</td>
      <td>3/24/2016 2:35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>999</th>
      <td>45.01</td>
      <td>26.0</td>
      <td>29875.80</td>
      <td>178.35</td>
      <td>Virtual 5thgeneration emulation</td>
      <td>Ronniemouth</td>
      <td>0</td>
      <td>Brazil</td>
      <td>6/3/2016 21:43</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



```python
data.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 1000 entries, 0 to 999
Data columns (total 10 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   Daily Time Spent on Site  1000 non-null   float64
 1   Age                       916 non-null    float64
 2   Area Income               1000 non-null   float64
 3   Daily Internet Usage      1000 non-null   float64
 4   Ad Topic Line             1000 non-null   object 
 5   City                      1000 non-null   object 
 6   Male                      1000 non-null   int64  
 7   Country                   1000 non-null   object 
 8   Timestamp                 1000 non-null   object 
 9   Clicked on Ad             1000 non-null   int64  
dtypes: float64(4), int64(2), object(4)
memory usage: 78.2+ KB
</pre>
Clicked on Ad가 종속변수로 우리가 예측할 값


Age만 916개가 non-null로 빈 값이 있음을 의미



```python
data.describe()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Daily Time Spent on Site</th>
      <th>Age</th>
      <th>Area Income</th>
      <th>Daily Internet Usage</th>
      <th>Male</th>
      <th>Clicked on Ad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1000.000000</td>
      <td>916.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.000000</td>
      <td>1000.00000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>65.000200</td>
      <td>36.128821</td>
      <td>55000.000080</td>
      <td>180.000100</td>
      <td>0.481000</td>
      <td>0.50000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>15.853615</td>
      <td>9.018548</td>
      <td>13414.634022</td>
      <td>43.902339</td>
      <td>0.499889</td>
      <td>0.50025</td>
    </tr>
    <tr>
      <th>min</th>
      <td>32.600000</td>
      <td>19.000000</td>
      <td>13996.500000</td>
      <td>104.780000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>51.360000</td>
      <td>29.000000</td>
      <td>47031.802500</td>
      <td>138.830000</td>
      <td>0.000000</td>
      <td>0.00000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>68.215000</td>
      <td>35.000000</td>
      <td>57012.300000</td>
      <td>183.130000</td>
      <td>0.000000</td>
      <td>0.50000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>78.547500</td>
      <td>42.000000</td>
      <td>65470.635000</td>
      <td>218.792500</td>
      <td>1.000000</td>
      <td>1.00000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>91.430000</td>
      <td>61.000000</td>
      <td>79484.800000</td>
      <td>269.960000</td>
      <td>1.000000</td>
      <td>1.00000</td>
    </tr>
  </tbody>
</table>
</div>


Area Income이 min과 25%의 차이가 커서 왼쪽으로 좀 치우친 것을 알 수 있다.


Male의 mean값이 0.48인 것으로 48%정도가 남자라는 것을 알 수 있다.


#### 시각화



```python
sns.displot(data['Area Income'])
```



```python
sns.displot(data['Age'])
```


고유값 갯수 확인



```python
data['Country'].nunique()
```

<pre>
237
</pre>

```python
data['City'].nunique()
```

<pre>
969
</pre>

```python
data['Ad Topic Line'].nunique()
```

<pre>
1000
</pre>
## Missing Value 확인 및 처리


Missing Value

- na

- NaN

- Null


#### Missing Value 확인



```python
data.isna()
```

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Daily Time Spent on Site</th>
      <th>Age</th>
      <th>Area Income</th>
      <th>Daily Internet Usage</th>
      <th>Ad Topic Line</th>
      <th>City</th>
      <th>Male</th>
      <th>Country</th>
      <th>Timestamp</th>
      <th>Clicked on Ad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>996</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>997</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>998</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>999</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 10 columns</p>
</div>



```python
data.isna().sum()
```

<pre>
Daily Time Spent on Site     0
Age                         84
Area Income                  0
Daily Internet Usage         0
Ad Topic Line                0
City                         0
Male                         0
Country                      0
Timestamp                    0
Clicked on Ad                0
dtype: int64
</pre>

```python
data.isna().sum() / len(data)
```

<pre>
Daily Time Spent on Site    0.000
Age                         0.084
Area Income                 0.000
Daily Internet Usage        0.000
Ad Topic Line               0.000
City                        0.000
Male                        0.000
Country                     0.000
Timestamp                   0.000
Clicked on Ad               0.000
dtype: float64
</pre>